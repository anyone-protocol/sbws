<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1113px" preserveAspectRatio="none" style="width:1793px;height:1113px;" version="1.1" viewBox="0 0 1793 1113" width="1793px" zoomAndPan="magnify"><defs><filter height="300%" id="fssrfq427eq2k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="1087.5" cy="20" fill="#000000" filter="url(#fssrfq427eq2k)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="155" x="1010" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="135" x="1020" y="71.1387">relay_as_entry = True</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1010.5,103.9688,1164.5,103.9688,1176.5,115.9688,1164.5,127.9688,1010.5,127.9688,998.5,115.9688,1010.5,103.9688" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="1010.5" y="119.7769">consensus has `cc_alg=2`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="978.5" y="113.3745">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1176.5" y="113.3745">no</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="754.5,137.9688,962.5,137.9688,974.5,149.9688,962.5,161.9688,754.5,161.9688,742.5,149.9688,754.5,137.9688" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="208" x="754.5" y="153.7769">consensus has `bwscanner_cc&gt;=1`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="722.5" y="147.3745">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="974.5" y="147.3745">no</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="160" x="611" y="220.3711"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140" x="621" y="241.5098">relay_as_entry = False</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="558.5,171.9688,823.5,171.9688,835.5,183.9688,823.5,195.9688,558.5,195.9688,546.5,183.9688,558.5,171.9688" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="695" y="206.1792">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="265" x="558.5" y="187.7769">relay to measure is exit AND has `FlowCtrl=2`</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="691,278.7422,703,290.7422,691,302.7422,679,290.7422,691,278.7422" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="160" x="946" y="220.3711"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140" x="956" y="241.5098">relay_as_entry = False</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="879.5,171.9688,1172.5,171.9688,1184.5,183.9688,1172.5,195.9688,879.5,195.9688,867.5,183.9688,879.5,171.9688" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1030" y="206.1792">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="293" x="879.5" y="187.7769">relay to measure is exit AND has NOT `FlowCtrl=2`</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1026,278.7422,1038,290.7422,1026,302.7422,1014,290.7422,1026,278.7422" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="858.5,308.7422,870.5,320.7422,858.5,332.7422,846.5,320.7422,858.5,308.7422" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="160" x="1236.5" y="186.3711"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140" x="1246.5" y="207.5098">relay_as_entry = False</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1245.5,137.9688,1387.5,137.9688,1399.5,149.9688,1387.5,161.9688,1245.5,161.9688,1233.5,149.9688,1245.5,137.9688" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1320.5" y="172.1792">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="1245.5" y="153.7769">relay to measure is exit?</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1316.5,244.7422,1328.5,256.7422,1316.5,268.7422,1304.5,256.7422,1316.5,244.7422" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1087.5,338.7422,1099.5,350.7422,1087.5,362.7422,1075.5,350.7422,1087.5,338.7422" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1010.5,382.7422,1164.5,382.7422,1176.5,394.7422,1164.5,406.7422,1010.5,406.7422,998.5,394.7422,1010.5,382.7422" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="1010.5" y="398.5503">consensus has `cc_alg=2`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="978.5" y="392.1479">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1176.5" y="392.1479">no</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="519,416.7422,727,416.7422,739,428.7422,727,440.7422,519,440.7422,507,428.7422,519,416.7422" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="208" x="519" y="432.5503">consensus has `bwscanner_cc&gt;=1`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="487" y="426.1479">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="739" y="426.1479">no</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="93.5,450.7422,500.5,450.7422,512.5,462.7422,500.5,474.7422,93.5,474.7422,81.5,462.7422,93.5,450.7422" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="407" x="93.5" y="466.5503">relay to measure is exit AND has `FlowCtrl=2` AND NOT relay_as_entry</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="61.5" y="460.1479">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="512.5" y="460.1479">no</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="11" y="484.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="21" y="505.8809">obtain non-exits</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="89.8438" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="173" x="436" y="484.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="446" y="505.8809">obtain exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="153" x="446" y="519.8496">with proto `FlowCtrol=2`</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="446" y="533.8184">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="446" y="547.7871">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="446" y="561.7559">to port 443</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="297,580.5859,309,592.5859,297,604.5859,285,592.5859,297,580.5859" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="731.5,450.7422,1166.5,450.7422,1178.5,462.7422,1166.5,474.7422,731.5,474.7422,719.5,462.7422,731.5,450.7422" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="435" x="731.5" y="466.5503">relay to measure is exit AND has NOT `FlowCtrl=2` AND NOT relay_as_entry</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="699.5" y="460.1479">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1178.5" y="460.1479">no</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="649" y="484.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="659" y="505.8809">obtain non-exits</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="89.8438" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="178" x="1099.5" y="484.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="1109.5" y="505.8809">obtain exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="158" x="1109.5" y="519.8496">with proto `FlowCtrol!=2`</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="1109.5" y="533.8184">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="1109.5" y="547.7871">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="1109.5" y="561.7559">to port 443</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="949,580.5859,961,592.5859,949,604.5859,937,592.5859,949,580.5859" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="623,610.5859,635,622.5859,623,634.5859,611,622.5859,623,610.5859" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1410,416.7422,1694,416.7422,1706,428.7422,1694,440.7422,1410,440.7422,1398,428.7422,1410,416.7422" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="284" x="1410" y="432.5503">relay to measure is exit AND NOT relay_as_entry?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1378" y="426.1479">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1706" y="426.1479">no</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="1327.5" y="450.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="1337.5" y="471.8809">obtain non-exits</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="75.875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="1655.5" y="450.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="1665.5" y="471.8809">obtain exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="1665.5" y="485.8496">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="1665.5" y="499.8184">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="1665.5" y="513.7871">to port 443</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1552,532.6172,1564,544.6172,1552,556.6172,1540,544.6172,1552,532.6172" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1087.5,640.5859,1099.5,652.5859,1087.5,664.5859,1075.5,652.5859,1087.5,640.5859" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="167" x="1004" y="684.5859"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="147" x="1014" y="705.7246">potential second relays</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="75.875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="115" x="1030" y="738.5547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="86" x="1040" y="759.6934">obtain a relay</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="88" x="1040" y="773.6621">from potential</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="1040" y="787.6309">sencond relays</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="1040" y="801.5996">randomly</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="704.5,834.4297,887.5,834.4297,899.5,846.4297,887.5,858.4297,704.5,858.4297,692.5,846.4297,704.5,834.4297" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="800" y="868.6401">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="183" x="704.5" y="850.2378">second relay has 2x bandwidth?</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="931.5,834.4297,1159.5,834.4297,1171.5,846.4297,1159.5,858.4297,931.5,858.4297,919.5,846.4297,931.5,834.4297" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1049.5" y="868.6401">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="228" x="931.5" y="850.2378">other second relay has 1.5x bandwidth?</text><polygon fill="#FEFECE" filter="url(#fssrfq427eq2k)" points="1203.5,834.4297,1420.5,834.4297,1432.5,846.4297,1420.5,858.4297,1203.5,858.4297,1191.5,846.4297,1203.5,834.4297" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1316" y="868.6401">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="217" x="1203.5" y="850.2378">other second relay has 1x bandwidth?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="42" x="1432.5" y="843.8354">nothing</text><ellipse cx="1467.5" cy="887.832" fill="#FFFFFF" filter="url(#fssrfq427eq2k)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="1467.5" cy="887.832" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="163" x="1006" y="938.832"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="143" x="1016" y="959.9707">second relay selected!</text><rect fill="#FEFECE" filter="url(#fssrfq427eq2k)" height="61.9063" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="104" x="1035.5" y="992.8008"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="1045.5" y="1013.9395">Build a circuit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="78" x="1045.5" y="1027.9082">whith exit as</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="74" x="1045.5" y="1041.877">second hop</text><ellipse cx="1087.5" cy="1085.707" fill="#FFFFFF" filter="url(#fssrfq427eq2k)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="1087.5" cy="1085.707" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="30" y2="50"/><polygon fill="#A80036" points="1083.5,40,1087.5,50,1091.5,40,1087.5,44" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="691" x2="691" y1="195.9688" y2="220.3711"/><polygon fill="#A80036" points="687,210.3711,691,220.3711,695,210.3711,691,214.3711" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="835.5" x2="847.5" y1="183.9688" y2="183.9688"/><polygon fill="#A80036" points="843.5,227.3555,847.5,237.3555,851.5,227.3555,847.5,231.3555" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="847.5" x2="847.5" y1="183.9688" y2="290.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="847.5" x2="703" y1="290.7422" y2="290.7422"/><polygon fill="#A80036" points="713,286.7422,703,290.7422,713,294.7422,709,290.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="691" x2="691" y1="254.3398" y2="278.7422"/><polygon fill="#A80036" points="687,268.7422,691,278.7422,695,268.7422,691,272.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1026" x2="1026" y1="195.9688" y2="220.3711"/><polygon fill="#A80036" points="1022,210.3711,1026,220.3711,1030,210.3711,1026,214.3711" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1184.5" x2="1196.5" y1="183.9688" y2="183.9688"/><polygon fill="#A80036" points="1192.5,227.3555,1196.5,237.3555,1200.5,227.3555,1196.5,231.3555" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1196.5" x2="1196.5" y1="183.9688" y2="290.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1196.5" x2="1038" y1="290.7422" y2="290.7422"/><polygon fill="#A80036" points="1048,286.7422,1038,290.7422,1048,294.7422,1044,290.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1026" x2="1026" y1="254.3398" y2="278.7422"/><polygon fill="#A80036" points="1022,268.7422,1026,278.7422,1030,268.7422,1026,272.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="742.5" x2="691" y1="149.9688" y2="149.9688"/><line style="stroke:#A80036;stroke-width:1.5;" x1="691" x2="691" y1="149.9688" y2="171.9688"/><polygon fill="#A80036" points="687,161.9688,691,171.9688,695,161.9688,691,165.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="974.5" x2="1026" y1="149.9688" y2="149.9688"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1026" x2="1026" y1="149.9688" y2="171.9688"/><polygon fill="#A80036" points="1022,161.9688,1026,171.9688,1030,161.9688,1026,165.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="691" x2="691" y1="302.7422" y2="320.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="691" x2="846.5" y1="320.7422" y2="320.7422"/><polygon fill="#A80036" points="836.5,316.7422,846.5,320.7422,836.5,324.7422,840.5,320.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1026" x2="1026" y1="302.7422" y2="320.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1026" x2="870.5" y1="320.7422" y2="320.7422"/><polygon fill="#A80036" points="880.5,316.7422,870.5,320.7422,880.5,324.7422,876.5,320.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1316.5" x2="1316.5" y1="161.9688" y2="186.3711"/><polygon fill="#A80036" points="1312.5,176.3711,1316.5,186.3711,1320.5,176.3711,1316.5,180.3711" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1399.5" x2="1411.5" y1="149.9688" y2="149.9688"/><polygon fill="#A80036" points="1407.5,193.3555,1411.5,203.3555,1415.5,193.3555,1411.5,197.3555" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1411.5" x2="1411.5" y1="149.9688" y2="256.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1411.5" x2="1328.5" y1="256.7422" y2="256.7422"/><polygon fill="#A80036" points="1338.5,252.7422,1328.5,256.7422,1338.5,260.7422,1334.5,256.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1316.5" x2="1316.5" y1="220.3398" y2="244.7422"/><polygon fill="#A80036" points="1312.5,234.7422,1316.5,244.7422,1320.5,234.7422,1316.5,238.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="998.5" x2="858.5" y1="115.9688" y2="115.9688"/><line style="stroke:#A80036;stroke-width:1.5;" x1="858.5" x2="858.5" y1="115.9688" y2="137.9688"/><polygon fill="#A80036" points="854.5,127.9688,858.5,137.9688,862.5,127.9688,858.5,131.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1176.5" x2="1316.5" y1="115.9688" y2="115.9688"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1316.5" x2="1316.5" y1="115.9688" y2="137.9688"/><polygon fill="#A80036" points="1312.5,127.9688,1316.5,137.9688,1320.5,127.9688,1316.5,131.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="858.5" x2="858.5" y1="332.7422" y2="350.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="858.5" x2="1075.5" y1="350.7422" y2="350.7422"/><polygon fill="#A80036" points="1065.5,346.7422,1075.5,350.7422,1065.5,354.7422,1069.5,350.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1316.5" x2="1316.5" y1="268.7422" y2="350.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1316.5" x2="1099.5" y1="350.7422" y2="350.7422"/><polygon fill="#A80036" points="1109.5,346.7422,1099.5,350.7422,1109.5,354.7422,1105.5,350.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="83.9688" y2="103.9688"/><polygon fill="#A80036" points="1083.5,93.9688,1087.5,103.9688,1091.5,93.9688,1087.5,97.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="81.5" x2="71.5" y1="462.7422" y2="462.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="71.5" x2="71.5" y1="462.7422" y2="484.7422"/><polygon fill="#A80036" points="67.5,474.7422,71.5,484.7422,75.5,474.7422,71.5,478.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="512.5" x2="522.5" y1="462.7422" y2="462.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="522.5" x2="522.5" y1="462.7422" y2="484.7422"/><polygon fill="#A80036" points="518.5,474.7422,522.5,484.7422,526.5,474.7422,522.5,478.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="71.5" x2="71.5" y1="518.7109" y2="592.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="71.5" x2="285" y1="592.5859" y2="592.5859"/><polygon fill="#A80036" points="275,588.5859,285,592.5859,275,596.5859,279,592.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="522.5" x2="522.5" y1="574.5859" y2="592.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="522.5" x2="309" y1="592.5859" y2="592.5859"/><polygon fill="#A80036" points="319,588.5859,309,592.5859,319,596.5859,315,592.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="719.5" x2="709.5" y1="462.7422" y2="462.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="709.5" x2="709.5" y1="462.7422" y2="484.7422"/><polygon fill="#A80036" points="705.5,474.7422,709.5,484.7422,713.5,474.7422,709.5,478.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1178.5" x2="1188.5" y1="462.7422" y2="462.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1188.5" x2="1188.5" y1="462.7422" y2="484.7422"/><polygon fill="#A80036" points="1184.5,474.7422,1188.5,484.7422,1192.5,474.7422,1188.5,478.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="709.5" x2="709.5" y1="518.7109" y2="592.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="709.5" x2="937" y1="592.5859" y2="592.5859"/><polygon fill="#A80036" points="927,588.5859,937,592.5859,927,596.5859,931,592.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1188.5" x2="1188.5" y1="574.5859" y2="592.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1188.5" x2="961" y1="592.5859" y2="592.5859"/><polygon fill="#A80036" points="971,588.5859,961,592.5859,971,596.5859,967,592.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="507" x2="297" y1="428.7422" y2="428.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="297" x2="297" y1="428.7422" y2="450.7422"/><polygon fill="#A80036" points="293,440.7422,297,450.7422,301,440.7422,297,444.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="739" x2="949" y1="428.7422" y2="428.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="949" x2="949" y1="428.7422" y2="450.7422"/><polygon fill="#A80036" points="945,440.7422,949,450.7422,953,440.7422,949,444.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="297" x2="297" y1="604.5859" y2="622.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="297" x2="611" y1="622.5859" y2="622.5859"/><polygon fill="#A80036" points="601,618.5859,611,622.5859,601,626.5859,605,622.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="949" x2="949" y1="604.5859" y2="622.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="949" x2="635" y1="622.5859" y2="622.5859"/><polygon fill="#A80036" points="645,618.5859,635,622.5859,645,626.5859,641,622.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1398" x2="1388" y1="428.7422" y2="428.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1388" x2="1388" y1="428.7422" y2="450.7422"/><polygon fill="#A80036" points="1384,440.7422,1388,450.7422,1392,440.7422,1388,444.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1706" x2="1716" y1="428.7422" y2="428.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1716" x2="1716" y1="428.7422" y2="450.7422"/><polygon fill="#A80036" points="1712,440.7422,1716,450.7422,1720,440.7422,1716,444.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1388" x2="1388" y1="484.7109" y2="544.6172"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1388" x2="1540" y1="544.6172" y2="544.6172"/><polygon fill="#A80036" points="1530,540.6172,1540,544.6172,1530,548.6172,1534,544.6172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1716" x2="1716" y1="526.6172" y2="544.6172"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1716" x2="1564" y1="544.6172" y2="544.6172"/><polygon fill="#A80036" points="1574,540.6172,1564,544.6172,1574,548.6172,1570,544.6172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="998.5" x2="623" y1="394.7422" y2="394.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="623" x2="623" y1="394.7422" y2="416.7422"/><polygon fill="#A80036" points="619,406.7422,623,416.7422,627,406.7422,623,410.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1176.5" x2="1552" y1="394.7422" y2="394.7422"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1552" x2="1552" y1="394.7422" y2="416.7422"/><polygon fill="#A80036" points="1548,406.7422,1552,416.7422,1556,406.7422,1552,410.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="623" x2="623" y1="634.5859" y2="652.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="623" x2="1075.5" y1="652.5859" y2="652.5859"/><polygon fill="#A80036" points="1065.5,648.5859,1075.5,652.5859,1065.5,656.5859,1069.5,652.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1552" x2="1552" y1="556.6172" y2="652.5859"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1552" x2="1099.5" y1="652.5859" y2="652.5859"/><polygon fill="#A80036" points="1109.5,648.5859,1099.5,652.5859,1109.5,656.5859,1105.5,652.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="362.7422" y2="382.7422"/><polygon fill="#A80036" points="1083.5,372.7422,1087.5,382.7422,1091.5,372.7422,1087.5,376.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="664.5859" y2="684.5859"/><polygon fill="#A80036" points="1083.5,674.5859,1087.5,684.5859,1091.5,674.5859,1087.5,678.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="718.5547" y2="738.5547"/><polygon fill="#A80036" points="1083.5,728.5547,1087.5,738.5547,1091.5,728.5547,1087.5,732.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="796" x2="796" y1="858.4297" y2="918.832"/><polygon fill="#A80036" points="792,908.832,796,918.832,800,908.832,796,912.832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1045.5" x2="1045.5" y1="858.4297" y2="918.832"/><polygon fill="#A80036" points="1041.5,908.832,1045.5,918.832,1049.5,908.832,1045.5,912.832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1312" x2="1312" y1="858.4297" y2="918.832"/><polygon fill="#A80036" points="1308,908.832,1312,918.832,1316,908.832,1312,912.832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="899.5" x2="919.5" y1="846.4297" y2="846.4297"/><polygon fill="#A80036" points="909.5,842.4297,919.5,846.4297,909.5,850.4297,913.5,846.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1171.5" x2="1191.5" y1="846.4297" y2="846.4297"/><polygon fill="#A80036" points="1181.5,842.4297,1191.5,846.4297,1181.5,850.4297,1185.5,846.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="814.4297" y2="819.4297"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="796" y1="819.4297" y2="819.4297"/><line style="stroke:#A80036;stroke-width:1.5;" x1="796" x2="796" y1="819.4297" y2="834.4297"/><polygon fill="#A80036" points="792,824.4297,796,834.4297,800,824.4297,796,828.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1432.5" x2="1467.5" y1="846.4297" y2="846.4297"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1467.5" x2="1467.5" y1="846.4297" y2="876.832"/><polygon fill="#A80036" points="1463.5,866.832,1467.5,876.832,1471.5,866.832,1467.5,870.832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="796" x2="1312" y1="918.832" y2="918.832"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="918.832" y2="938.832"/><polygon fill="#A80036" points="1083.5,928.832,1087.5,938.832,1091.5,928.832,1087.5,932.832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="972.8008" y2="992.8008"/><polygon fill="#A80036" points="1083.5,982.8008,1087.5,992.8008,1091.5,982.8008,1087.5,986.8008" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1087.5" x2="1087.5" y1="1054.707" y2="1074.707"/><polygon fill="#A80036" points="1083.5,1064.707,1087.5,1074.707,1091.5,1064.707,1087.5,1068.707" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[d7214468bee7e86ba2f231b18b394dbc]
@startuml

start

:relay_as_entry = True;
if (consensus has `cc_alg=2`) then (yes)
  if (consensus has `bwscanner_cc>=1`) then (yes)
    if (relay to measure is exit AND has `FlowCtrl=2`) then (yes)
      :relay_as_entry = False;
    endif
  'no bwscanner>=1
  else (no)
    if (relay to measure is exit AND has NOT `FlowCtrl=2`) then (yes)
      :relay_as_entry = False;
    endif
  endif
' no cc_alg=2
else (no)
  if (relay to measure is exit?) then (yes)
      :relay_as_entry = False;
  endif
endif


if (consensus has `cc_alg=2`) then (yes)
  if (consensus has `bwscanner_cc>=1`) then (yes)
    if (relay to measure is exit AND has `FlowCtrl=2` AND NOT relay_as_entry) then (yes)
      :obtain non-exits;
    else (no)
      :obtain exits
      with proto `FlowCtrol=2`
      without bad flag
      that can exit
      to port 443;
    endif
  'no bwscanner>=1
  else (no)
    if (relay to measure is exit AND has NOT `FlowCtrl=2` AND NOT relay_as_entry) then (yes)
      :obtain non-exits;
    else (no)
      :obtain exits
      with proto `FlowCtrol!=2`
      without bad flag
      that can exit
      to port 443;
    endif
  endif
' no cc_alg=2
else (no)
  if (relay to measure is exit AND NOT relay_as_entry?) then (yes)
    :obtain non-exits;
  else (no)
    :obtain exits
    without bad flag
    that can exit
    to port 443;
  endif
endif


:potential second relays;
:obtain a relay
from potential
sencond relays
randomly;
if (second relay has 2x bandwidth?) then (yes)
elseif (other second relay has 1.5x bandwidth?) then (yes)
elseif (other second relay has 1x bandwidth?) then (yes)
else (nothing)
  stop
endif
:second relay selected!;
:Build a circuit
whith exit as
second hop;
stop

@enduml

@startuml

start

:relay_as_entry = True;
if (consensus has `cc_alg=2`) then (yes)
  if (consensus has `bwscanner_cc>=1`) then (yes)
    if (relay to measure is exit AND has `FlowCtrl=2`) then (yes)
      :relay_as_entry = False;
    endif
  else (no)
    if (relay to measure is exit AND has NOT `FlowCtrl=2`) then (yes)
      :relay_as_entry = False;
    endif
  endif
else (no)
  if (relay to measure is exit?) then (yes)
      :relay_as_entry = False;
  endif
endif


if (consensus has `cc_alg=2`) then (yes)
  if (consensus has `bwscanner_cc>=1`) then (yes)
    if (relay to measure is exit AND has `FlowCtrl=2` AND NOT relay_as_entry) then (yes)
      :obtain non-exits;
    else (no)
      :obtain exits
      with proto `FlowCtrol=2`
      without bad flag
      that can exit
      to port 443;
    endif
  else (no)
    if (relay to measure is exit AND has NOT `FlowCtrl=2` AND NOT relay_as_entry) then (yes)
      :obtain non-exits;
    else (no)
      :obtain exits
      with proto `FlowCtrol!=2`
      without bad flag
      that can exit
      to port 443;
    endif
  endif
else (no)
  if (relay to measure is exit AND NOT relay_as_entry?) then (yes)
    :obtain non-exits;
  else (no)
    :obtain exits
    without bad flag
    that can exit
    to port 443;
  endif
endif


:potential second relays;
:obtain a relay
from potential
sencond relays
randomly;
if (second relay has 2x bandwidth?) then (yes)
elseif (other second relay has 1.5x bandwidth?) then (yes)
elseif (other second relay has 1x bandwidth?) then (yes)
else (nothing)
  stop
endif
:second relay selected!;
:Build a circuit
whith exit as
second hop;
stop

@enduml

PlantUML version 1.2021.00(Sun Jan 10 10:25:05 GMT 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>