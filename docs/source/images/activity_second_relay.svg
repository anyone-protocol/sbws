<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="716px" preserveAspectRatio="none" style="width:835px;height:716px;" version="1.1" viewBox="0 0 835 716" width="835px" zoomAndPan="magnify"><defs><filter height="300%" id="fuxnn6ywm67wb" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="427.75" cy="20" fill="#000000" filter="url(#fuxnn6ywm67wb)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="350.75,50,504.75,50,516.75,62,504.75,74,350.75,74,338.75,62,350.75,50" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="350.75" y="65.8081">consensus has `cc_alg=2`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="318.75" y="59.4058">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="516.75" y="59.4058">no</text><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="119.5,84,327.5,84,339.5,96,327.5,108,119.5,108,107.5,96,119.5,84" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="208" x="119.5" y="99.8081">consensus has `bwscanner_cc&gt;=1`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="87.5" y="93.4058">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="339.5" y="93.4058">no</text><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="89.8438" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="173" x="11" y="118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="21" y="139.1387">obtain exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="153" x="21" y="153.1074">with proto `FlowCtrol=2`</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="21" y="167.0762">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="21" y="181.0449">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="21" y="195.0137">to port 443</text><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="89.8438" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="178" x="260.5" y="118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="270.5" y="139.1387">obtain exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="158" x="270.5" y="153.1074">with proto `FlowCtrol!=2`</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="270.5" y="167.0762">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="270.5" y="181.0449">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="270.5" y="195.0137">to port 443</text><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="223.5,213.8438,235.5,225.8438,223.5,237.8438,211.5,225.8438,223.5,213.8438" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="561,84,703,84,715,96,703,108,561,108,549,96,561,84" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="561" y="99.8081">relay to measure is exit?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="529" y="93.4058">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="715" y="93.4058">no</text><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="478.5" y="118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="488.5" y="139.1387">obtain non-exits</text><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="75.875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="664.5" y="118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="674.5" y="139.1387">obtain an exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="674.5" y="153.1074">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="674.5" y="167.0762">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="674.5" y="181.0449">to port 443</text><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="632,199.875,644,211.875,632,223.875,620,211.875,632,199.875" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="427.75,243.8438,439.75,255.8438,427.75,267.8438,415.75,255.8438,427.75,243.8438" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="167" x="344.25" y="287.8438"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="147" x="354.25" y="308.9824">potential second relays</text><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="75.875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="115" x="370.25" y="341.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="86" x="380.25" y="362.9512">obtain a relay</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="88" x="380.25" y="376.9199">from potential</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="380.25" y="390.8887">sencond relays</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="380.25" y="404.8574">randomly</text><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="44.75,437.6875,227.75,437.6875,239.75,449.6875,227.75,461.6875,44.75,461.6875,32.75,449.6875,44.75,437.6875" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="140.25" y="471.8979">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="183" x="44.75" y="453.4956">second relay has 2x bandwidth?</text><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="271.75,437.6875,499.75,437.6875,511.75,449.6875,499.75,461.6875,271.75,461.6875,259.75,449.6875,271.75,437.6875" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="389.75" y="471.8979">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="228" x="271.75" y="453.4956">other second relay has 1.5x bandwidth?</text><polygon fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" points="543.75,437.6875,760.75,437.6875,772.75,449.6875,760.75,461.6875,543.75,461.6875,531.75,449.6875,543.75,437.6875" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="656.25" y="471.8979">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="217" x="543.75" y="453.4956">other second relay has 1x bandwidth?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="42" x="772.75" y="447.0933">nothing</text><ellipse cx="807.75" cy="491.0898" fill="#FFFFFF" filter="url(#fuxnn6ywm67wb)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="807.75" cy="491.0898" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="163" x="346.25" y="542.0898"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="143" x="356.25" y="563.2285">second relay selected!</text><rect fill="#FEFECE" filter="url(#fuxnn6ywm67wb)" height="61.9063" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="104" x="375.75" y="596.0586"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="385.75" y="617.1973">Build a circuit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="78" x="385.75" y="631.166">whith exit as</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="74" x="385.75" y="645.1348">second hop</text><ellipse cx="427.75" cy="688.9648" fill="#FFFFFF" filter="url(#fuxnn6ywm67wb)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="427.75" cy="688.9648" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="107.5" x2="97.5" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="97.5" x2="97.5" y1="96" y2="118"/><polygon fill="#A80036" points="93.5,108,97.5,118,101.5,108,97.5,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="339.5" x2="349.5" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="349.5" x2="349.5" y1="96" y2="118"/><polygon fill="#A80036" points="345.5,108,349.5,118,353.5,108,349.5,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="97.5" x2="97.5" y1="207.8438" y2="225.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="97.5" x2="211.5" y1="225.8438" y2="225.8438"/><polygon fill="#A80036" points="201.5,221.8438,211.5,225.8438,201.5,229.8438,205.5,225.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="349.5" x2="349.5" y1="207.8438" y2="225.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="349.5" x2="235.5" y1="225.8438" y2="225.8438"/><polygon fill="#A80036" points="245.5,221.8438,235.5,225.8438,245.5,229.8438,241.5,225.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="549" x2="539" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="539" x2="539" y1="96" y2="118"/><polygon fill="#A80036" points="535,108,539,118,543,108,539,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="715" x2="725" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="725" x2="725" y1="96" y2="118"/><polygon fill="#A80036" points="721,108,725,118,729,108,725,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="539" x2="539" y1="151.9688" y2="211.875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="539" x2="620" y1="211.875" y2="211.875"/><polygon fill="#A80036" points="610,207.875,620,211.875,610,215.875,614,211.875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="725" x2="725" y1="193.875" y2="211.875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="725" x2="644" y1="211.875" y2="211.875"/><polygon fill="#A80036" points="654,207.875,644,211.875,654,215.875,650,211.875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="338.75" x2="223.5" y1="62" y2="62"/><line style="stroke:#A80036;stroke-width:1.5;" x1="223.5" x2="223.5" y1="62" y2="84"/><polygon fill="#A80036" points="219.5,74,223.5,84,227.5,74,223.5,78" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="516.75" x2="632" y1="62" y2="62"/><line style="stroke:#A80036;stroke-width:1.5;" x1="632" x2="632" y1="62" y2="84"/><polygon fill="#A80036" points="628,74,632,84,636,74,632,78" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="223.5" x2="223.5" y1="237.8438" y2="255.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="223.5" x2="415.75" y1="255.8438" y2="255.8438"/><polygon fill="#A80036" points="405.75,251.8438,415.75,255.8438,405.75,259.8438,409.75,255.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="632" x2="632" y1="223.875" y2="255.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="632" x2="439.75" y1="255.8438" y2="255.8438"/><polygon fill="#A80036" points="449.75,251.8438,439.75,255.8438,449.75,259.8438,445.75,255.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="427.75" y1="30" y2="50"/><polygon fill="#A80036" points="423.75,40,427.75,50,431.75,40,427.75,44" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="427.75" y1="267.8438" y2="287.8438"/><polygon fill="#A80036" points="423.75,277.8438,427.75,287.8438,431.75,277.8438,427.75,281.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="427.75" y1="321.8125" y2="341.8125"/><polygon fill="#A80036" points="423.75,331.8125,427.75,341.8125,431.75,331.8125,427.75,335.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="136.25" x2="136.25" y1="461.6875" y2="522.0898"/><polygon fill="#A80036" points="132.25,512.0898,136.25,522.0898,140.25,512.0898,136.25,516.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="385.75" x2="385.75" y1="461.6875" y2="522.0898"/><polygon fill="#A80036" points="381.75,512.0898,385.75,522.0898,389.75,512.0898,385.75,516.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="652.25" x2="652.25" y1="461.6875" y2="522.0898"/><polygon fill="#A80036" points="648.25,512.0898,652.25,522.0898,656.25,512.0898,652.25,516.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="239.75" x2="259.75" y1="449.6875" y2="449.6875"/><polygon fill="#A80036" points="249.75,445.6875,259.75,449.6875,249.75,453.6875,253.75,449.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="511.75" x2="531.75" y1="449.6875" y2="449.6875"/><polygon fill="#A80036" points="521.75,445.6875,531.75,449.6875,521.75,453.6875,525.75,449.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="427.75" y1="417.6875" y2="422.6875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="136.25" y1="422.6875" y2="422.6875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="136.25" x2="136.25" y1="422.6875" y2="437.6875"/><polygon fill="#A80036" points="132.25,427.6875,136.25,437.6875,140.25,427.6875,136.25,431.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="772.75" x2="807.75" y1="449.6875" y2="449.6875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="807.75" x2="807.75" y1="449.6875" y2="480.0898"/><polygon fill="#A80036" points="803.75,470.0898,807.75,480.0898,811.75,470.0898,807.75,474.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="136.25" x2="652.25" y1="522.0898" y2="522.0898"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="427.75" y1="522.0898" y2="542.0898"/><polygon fill="#A80036" points="423.75,532.0898,427.75,542.0898,431.75,532.0898,427.75,536.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="427.75" y1="576.0586" y2="596.0586"/><polygon fill="#A80036" points="423.75,586.0586,427.75,596.0586,431.75,586.0586,427.75,590.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="427.75" x2="427.75" y1="657.9648" y2="677.9648"/><polygon fill="#A80036" points="423.75,667.9648,427.75,677.9648,431.75,667.9648,427.75,671.9648" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[04d85ca0e97be3d7dbc7fcb381244c12]
@startuml

start

if (consensus has `cc_alg=2`) then (yes)
  if (consensus has `bwscanner_cc>=1`) then (yes)
    :obtain exits
    with proto `FlowCtrol=2`
    without bad flag
    that can exit
    to port 443;
  else (no)
    :obtain exits
    with proto `FlowCtrol!=2`
    without bad flag
    that can exit
    to port 443;
  endif
else (no)
  if (relay to measure is exit?) then (yes)
    :obtain non-exits;
  else (no)
    :obtain an exits
    without bad flag
    that can exit
    to port 443;
  endif
endif
:potential second relays;
:obtain a relay
from potential
sencond relays
randomly;
if (second relay has 2x bandwidth?) then (yes)
elseif (other second relay has 1.5x bandwidth?) then (yes)
elseif (other second relay has 1x bandwidth?) then (yes)
else (nothing)
  stop
endif
:second relay selected!;
:Build a circuit
whith exit as
second hop;
stop

@enduml

PlantUML version 1.2021.00(Sun Jan 10 10:25:05 GMT 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>