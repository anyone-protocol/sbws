<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="849px" preserveAspectRatio="none" style="width:1374px;height:849px;" version="1.1" viewBox="0 0 1374 849" width="1374px" zoomAndPan="magnify"><defs><filter height="300%" id="f11lu9amh927jv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="840.125" cy="20" fill="#000000" filter="url(#f11lu9amh927jv)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="763.125,50,917.125,50,929.125,62,917.125,74,763.125,74,751.125,62,763.125,50" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="763.125" y="65.8081">consensus has `cc_alg=2`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="731.125" y="59.4058">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="929.125" y="59.4058">no</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="377.75,84,585.75,84,597.75,96,585.75,108,377.75,108,365.75,96,377.75,84" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="208" x="377.75" y="99.8081">consensus has `bwscanner_cc&gt;=1`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="345.75" y="93.4058">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="597.75" y="93.4058">no</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="94,118,359,118,371,130,359,142,94,142,82,130,94,118" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="265" x="94" y="133.8081">relay to measure is exit AND has `FlowCtrl=2`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="62" y="127.4058">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="371" y="127.4058">no</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="122" x="11" y="152"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="102" x="21" y="173.1387">use relay as exit</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="11.5" y="220.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="21.5" y="242.1074">obtain non-exits</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="132" x="315" y="152"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="112" x="325" y="173.1387">use relay as entry</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="89.8438" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="173" x="294.5" y="220.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="304.5" y="242.1074">obtain exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="153" x="304.5" y="256.0762">with proto `FlowCtrol=2`</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="304.5" y="270.0449">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="304.5" y="284.0137">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="304.5" y="297.9824">to port 443</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="226.5,316.8125,238.5,328.8125,226.5,340.8125,214.5,328.8125,226.5,316.8125" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="590.5,118,883.5,118,895.5,130,883.5,142,590.5,142,578.5,130,590.5,118" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="293" x="590.5" y="133.8081">relay to measure is exit AND has NOT `FlowCtrl=2`</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="558.5" y="127.4058">yes</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="122" x="507.5" y="152"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="102" x="517.5" y="173.1387">use relay as exit</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="508" y="220.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="518" y="242.1074">obtain non-exits</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="132" x="839.5" y="152"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="112" x="849.5" y="173.1387">use relay as entry</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="89.8438" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="178" x="816.5" y="220.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="73" x="826.5" y="242.1074">obtain exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="158" x="826.5" y="256.0762">with proto `FlowCtrol!=2`</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="826.5" y="270.0449">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="826.5" y="284.0137">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="826.5" y="297.9824">to port 443</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="737,316.8125,749,328.8125,737,340.8125,725,328.8125,737,316.8125" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="481.75,346.8125,493.75,358.8125,481.75,370.8125,469.75,358.8125,481.75,346.8125" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="1127.5,84,1269.5,84,1281.5,96,1269.5,108,1127.5,108,1115.5,96,1127.5,84" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="1127.5" y="99.8081">relay to measure is exit?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1095.5" y="93.4058">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1281.5" y="93.4058">no</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="122" x="1044.5" y="118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="102" x="1054.5" y="139.1387">use relay as exit</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="1045" y="186.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="1055" y="208.1074">obtain non-exits</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="132" x="1225.5" y="118"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="112" x="1235.5" y="139.1387">use relay as entry</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="75.875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="121" x="1231" y="186.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="1241" y="208.1074">obtain an exits</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="1241" y="222.0762">without bad flag</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="79" x="1241" y="236.0449">that can exit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="1241" y="250.0137">to port 443</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="1198.5,268.8438,1210.5,280.8438,1198.5,292.8438,1186.5,280.8438,1198.5,268.8438" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="840.125,376.8125,852.125,388.8125,840.125,400.8125,828.125,388.8125,840.125,376.8125" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="167" x="756.625" y="420.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="147" x="766.625" y="441.9512">potential second relays</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="75.875" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="115" x="782.625" y="474.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="86" x="792.625" y="495.9199">obtain a relay</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="88" x="792.625" y="509.8887">from potential</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="792.625" y="523.8574">sencond relays</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="792.625" y="537.8262">randomly</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="457.125,570.6563,640.125,570.6563,652.125,582.6563,640.125,594.6563,457.125,594.6563,445.125,582.6563,457.125,570.6563" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="552.625" y="604.8667">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="183" x="457.125" y="586.4644">second relay has 2x bandwidth?</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="684.125,570.6563,912.125,570.6563,924.125,582.6563,912.125,594.6563,684.125,594.6563,672.125,582.6563,684.125,570.6563" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="802.125" y="604.8667">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="228" x="684.125" y="586.4644">other second relay has 1.5x bandwidth?</text><polygon fill="#FEFECE" filter="url(#f11lu9amh927jv)" points="956.125,570.6563,1173.125,570.6563,1185.125,582.6563,1173.125,594.6563,956.125,594.6563,944.125,582.6563,956.125,570.6563" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1068.625" y="604.8667">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="217" x="956.125" y="586.4644">other second relay has 1x bandwidth?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="42" x="1185.125" y="580.062">nothing</text><ellipse cx="1220.125" cy="624.0586" fill="#FFFFFF" filter="url(#f11lu9amh927jv)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="1220.125" cy="624.0586" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="163" x="758.625" y="675.0586"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="143" x="768.625" y="696.1973">second relay selected!</text><rect fill="#FEFECE" filter="url(#f11lu9amh927jv)" height="61.9063" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="104" x="788.125" y="729.0273"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="798.125" y="750.166">Build a circuit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="78" x="798.125" y="764.1348">whith exit as</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="74" x="798.125" y="778.1035">second hop</text><ellipse cx="840.125" cy="821.9336" fill="#FFFFFF" filter="url(#f11lu9amh927jv)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="840.125" cy="821.9336" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="72" x2="72" y1="185.9688" y2="220.9688"/><polygon fill="#A80036" points="68,210.9688,72,220.9688,76,210.9688,72,214.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="381" x2="381" y1="185.9688" y2="220.9688"/><polygon fill="#A80036" points="377,210.9688,381,220.9688,385,210.9688,381,214.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="82" x2="72" y1="130" y2="130"/><line style="stroke:#A80036;stroke-width:1.5;" x1="72" x2="72" y1="130" y2="152"/><polygon fill="#A80036" points="68,142,72,152,76,142,72,146" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="371" x2="381" y1="130" y2="130"/><line style="stroke:#A80036;stroke-width:1.5;" x1="381" x2="381" y1="130" y2="152"/><polygon fill="#A80036" points="377,142,381,152,385,142,381,146" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="72" x2="72" y1="254.9375" y2="328.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="72" x2="214.5" y1="328.8125" y2="328.8125"/><polygon fill="#A80036" points="204.5,324.8125,214.5,328.8125,204.5,332.8125,208.5,328.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="381" x2="381" y1="310.8125" y2="328.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="381" x2="238.5" y1="328.8125" y2="328.8125"/><polygon fill="#A80036" points="248.5,324.8125,238.5,328.8125,248.5,332.8125,244.5,328.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="568.5" x2="568.5" y1="185.9688" y2="220.9688"/><polygon fill="#A80036" points="564.5,210.9688,568.5,220.9688,572.5,210.9688,568.5,214.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="905.5" x2="905.5" y1="185.9688" y2="220.9688"/><polygon fill="#A80036" points="901.5,210.9688,905.5,220.9688,909.5,210.9688,905.5,214.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="578.5" x2="568.5" y1="130" y2="130"/><line style="stroke:#A80036;stroke-width:1.5;" x1="568.5" x2="568.5" y1="130" y2="152"/><polygon fill="#A80036" points="564.5,142,568.5,152,572.5,142,568.5,146" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="895.5" x2="905.5" y1="130" y2="130"/><line style="stroke:#A80036;stroke-width:1.5;" x1="905.5" x2="905.5" y1="130" y2="152"/><polygon fill="#A80036" points="901.5,142,905.5,152,909.5,142,905.5,146" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="568.5" x2="568.5" y1="254.9375" y2="328.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="568.5" x2="725" y1="328.8125" y2="328.8125"/><polygon fill="#A80036" points="715,324.8125,725,328.8125,715,332.8125,719,328.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="905.5" x2="905.5" y1="310.8125" y2="328.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="905.5" x2="749" y1="328.8125" y2="328.8125"/><polygon fill="#A80036" points="759,324.8125,749,328.8125,759,332.8125,755,328.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="365.75" x2="226.5" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="226.5" x2="226.5" y1="96" y2="118"/><polygon fill="#A80036" points="222.5,108,226.5,118,230.5,108,226.5,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="597.75" x2="737" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="737" x2="737" y1="96" y2="118"/><polygon fill="#A80036" points="733,108,737,118,741,108,737,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="226.5" x2="226.5" y1="340.8125" y2="358.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="226.5" x2="469.75" y1="358.8125" y2="358.8125"/><polygon fill="#A80036" points="459.75,354.8125,469.75,358.8125,459.75,362.8125,463.75,358.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="737" x2="737" y1="340.8125" y2="358.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="737" x2="493.75" y1="358.8125" y2="358.8125"/><polygon fill="#A80036" points="503.75,354.8125,493.75,358.8125,503.75,362.8125,499.75,358.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1105.5" x2="1105.5" y1="151.9688" y2="186.9688"/><polygon fill="#A80036" points="1101.5,176.9688,1105.5,186.9688,1109.5,176.9688,1105.5,180.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1291.5" x2="1291.5" y1="151.9688" y2="186.9688"/><polygon fill="#A80036" points="1287.5,176.9688,1291.5,186.9688,1295.5,176.9688,1291.5,180.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1115.5" x2="1105.5" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1105.5" x2="1105.5" y1="96" y2="118"/><polygon fill="#A80036" points="1101.5,108,1105.5,118,1109.5,108,1105.5,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1281.5" x2="1291.5" y1="96" y2="96"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1291.5" x2="1291.5" y1="96" y2="118"/><polygon fill="#A80036" points="1287.5,108,1291.5,118,1295.5,108,1291.5,112" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1105.5" x2="1105.5" y1="220.9375" y2="280.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1105.5" x2="1186.5" y1="280.8438" y2="280.8438"/><polygon fill="#A80036" points="1176.5,276.8438,1186.5,280.8438,1176.5,284.8438,1180.5,280.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1291.5" x2="1291.5" y1="262.8438" y2="280.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1291.5" x2="1210.5" y1="280.8438" y2="280.8438"/><polygon fill="#A80036" points="1220.5,276.8438,1210.5,280.8438,1220.5,284.8438,1216.5,280.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="751.125" x2="481.75" y1="62" y2="62"/><line style="stroke:#A80036;stroke-width:1.5;" x1="481.75" x2="481.75" y1="62" y2="84"/><polygon fill="#A80036" points="477.75,74,481.75,84,485.75,74,481.75,78" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="929.125" x2="1198.5" y1="62" y2="62"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1198.5" x2="1198.5" y1="62" y2="84"/><polygon fill="#A80036" points="1194.5,74,1198.5,84,1202.5,74,1198.5,78" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="481.75" x2="481.75" y1="370.8125" y2="388.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="481.75" x2="828.125" y1="388.8125" y2="388.8125"/><polygon fill="#A80036" points="818.125,384.8125,828.125,388.8125,818.125,392.8125,822.125,388.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1198.5" x2="1198.5" y1="292.8438" y2="388.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1198.5" x2="852.125" y1="388.8125" y2="388.8125"/><polygon fill="#A80036" points="862.125,384.8125,852.125,388.8125,862.125,392.8125,858.125,388.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="840.125" y1="30" y2="50"/><polygon fill="#A80036" points="836.125,40,840.125,50,844.125,40,840.125,44" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="840.125" y1="400.8125" y2="420.8125"/><polygon fill="#A80036" points="836.125,410.8125,840.125,420.8125,844.125,410.8125,840.125,414.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="840.125" y1="454.7813" y2="474.7813"/><polygon fill="#A80036" points="836.125,464.7813,840.125,474.7813,844.125,464.7813,840.125,468.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="548.625" x2="548.625" y1="594.6563" y2="655.0586"/><polygon fill="#A80036" points="544.625,645.0586,548.625,655.0586,552.625,645.0586,548.625,649.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="798.125" x2="798.125" y1="594.6563" y2="655.0586"/><polygon fill="#A80036" points="794.125,645.0586,798.125,655.0586,802.125,645.0586,798.125,649.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1064.625" x2="1064.625" y1="594.6563" y2="655.0586"/><polygon fill="#A80036" points="1060.625,645.0586,1064.625,655.0586,1068.625,645.0586,1064.625,649.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="652.125" x2="672.125" y1="582.6563" y2="582.6563"/><polygon fill="#A80036" points="662.125,578.6563,672.125,582.6563,662.125,586.6563,666.125,582.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="924.125" x2="944.125" y1="582.6563" y2="582.6563"/><polygon fill="#A80036" points="934.125,578.6563,944.125,582.6563,934.125,586.6563,938.125,582.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="840.125" y1="550.6563" y2="555.6563"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="548.625" y1="555.6563" y2="555.6563"/><line style="stroke:#A80036;stroke-width:1.5;" x1="548.625" x2="548.625" y1="555.6563" y2="570.6563"/><polygon fill="#A80036" points="544.625,560.6563,548.625,570.6563,552.625,560.6563,548.625,564.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1185.125" x2="1220.125" y1="582.6563" y2="582.6563"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1220.125" x2="1220.125" y1="582.6563" y2="613.0586"/><polygon fill="#A80036" points="1216.125,603.0586,1220.125,613.0586,1224.125,603.0586,1220.125,607.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="548.625" x2="1064.625" y1="655.0586" y2="655.0586"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="840.125" y1="655.0586" y2="675.0586"/><polygon fill="#A80036" points="836.125,665.0586,840.125,675.0586,844.125,665.0586,840.125,669.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="840.125" y1="709.0273" y2="729.0273"/><polygon fill="#A80036" points="836.125,719.0273,840.125,729.0273,844.125,719.0273,840.125,723.0273" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="840.125" x2="840.125" y1="790.9336" y2="810.9336"/><polygon fill="#A80036" points="836.125,800.9336,840.125,810.9336,844.125,800.9336,840.125,804.9336" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[cefcbd35ca43a3f59932ef8ec365ce68]
@startuml

start

if (consensus has `cc_alg=2`) then (yes)
  if (consensus has `bwscanner_cc>=1`) then (yes)
    if (relay to measure is exit AND has `FlowCtrl=2`) then (yes)
      :use relay as exit;
      :obtain non-exits;
    else (no)
      :use relay as entry;
      :obtain exits
      with proto `FlowCtrol=2`
      without bad flag
      that can exit
      to port 443;
    endif
  'no bwscanner>=1
  else (no)
    if (relay to measure is exit AND has NOT `FlowCtrl=2`) then (yes)
      :use relay as exit;
      :obtain non-exits;
    else
      :use relay as entry;
      :obtain exits
      with proto `FlowCtrol!=2`
      without bad flag
      that can exit
      to port 443;
    endif
  endif
' no cc_alg=2
else (no)
  if (relay to measure is exit?) then (yes)
    :use relay as exit;
    :obtain non-exits;
  else (no)
    :use relay as entry;
    :obtain an exits
    without bad flag
    that can exit
    to port 443;
  endif
endif

:potential second relays;
:obtain a relay
from potential
sencond relays
randomly;
if (second relay has 2x bandwidth?) then (yes)
elseif (other second relay has 1.5x bandwidth?) then (yes)
elseif (other second relay has 1x bandwidth?) then (yes)
else (nothing)
  stop
endif
:second relay selected!;
:Build a circuit
whith exit as
second hop;
stop

@enduml

@startuml

start

if (consensus has `cc_alg=2`) then (yes)
  if (consensus has `bwscanner_cc>=1`) then (yes)
    if (relay to measure is exit AND has `FlowCtrl=2`) then (yes)
      :use relay as exit;
      :obtain non-exits;
    else (no)
      :use relay as entry;
      :obtain exits
      with proto `FlowCtrol=2`
      without bad flag
      that can exit
      to port 443;
    endif
  else (no)
    if (relay to measure is exit AND has NOT `FlowCtrl=2`) then (yes)
      :use relay as exit;
      :obtain non-exits;
    else
      :use relay as entry;
      :obtain exits
      with proto `FlowCtrol!=2`
      without bad flag
      that can exit
      to port 443;
    endif
  endif
else (no)
  if (relay to measure is exit?) then (yes)
    :use relay as exit;
    :obtain non-exits;
  else (no)
    :use relay as entry;
    :obtain an exits
    without bad flag
    that can exit
    to port 443;
  endif
endif

:potential second relays;
:obtain a relay
from potential
sencond relays
randomly;
if (second relay has 2x bandwidth?) then (yes)
elseif (other second relay has 1.5x bandwidth?) then (yes)
elseif (other second relay has 1x bandwidth?) then (yes)
else (nothing)
  stop
endif
:second relay selected!;
:Build a circuit
whith exit as
second hop;
stop

@enduml

PlantUML version 1.2021.00(Sun Jan 10 10:25:05 GMT 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>